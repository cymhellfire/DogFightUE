# 卡牌

卡牌脚本定义了一张卡牌的使用方式以及使用后产生的效果。

<!-- TOC -->
* [卡牌](#)
  * [创建新的卡牌类型](#)
    * [基本结构](#)
    * [流程函数](#)
      * [OnInitialized()](#oninitialized--)
  * [常用函数](#)
    * [创建属性](#)
<!-- TOC -->

## 创建新的卡牌类型

每一种卡牌都有一个对应的Lua脚本文件，其中的代码定义了卡牌的行为。本节简略说明如何创建一个新的卡牌类型。

### 基本结构

卡牌使用的Lua脚本都遵循一个基本结构，如下所示：

```
require "Unlua"

--定义卡牌类型
local XXX = Class("DogFight.Cards.CardBase")

--其他代码

--返回定义的类型
return XXX
```

例子中XXX为修改器类型名称，推荐使用包括*Card*关键字的名称以提高辨识度，如*CardFireball*。

### 流程函数

流程函数指的是一张卡牌从创建到使用完成，必定会执行的基础函数。在卡牌脚本中添加这些函数可以修改卡牌在不同阶段的行为逻辑。

#### OnInitialized()

`OnInitialized()`函数在卡牌创建后第一时间执行，可用来对卡牌进行初始化。常用来添加卡牌使用的属性。

```
function CardXXX:OnInitialized()
    -- 创建属性
    self:AddAttribute({
        Name = "Damage",
        DataType = "Integer",
        Value = 50,
        Tags = {"Tag1", "Tag2"},
    })
end
```

## 常用函数

本节主要介绍卡牌脚本常用的函数。

### 创建属性

可使用`AddAttribute()`函数为当前卡牌创建属性，该函数接收一个表作为创建参数，内容如下：

| 属性名      | 作用         | 备注                                                  |
|----------|------------|-----------------------------------------------------|
| Name     | 指定新属性的名称   | 该名称将使用在各种与属性相关的函数参数中，需谨慎选择。                         |
| DataType | 指定新属性的数据类型 | 需从Boolean（布尔），Integer（整数）和Float（小数）中选择一个，不选则无法创建属性。 |
| Value    | 指定属性的初始值   | 初始值为属性在没有任何修改器影响下的数值。                               |
| Tags     | 指定属性的标签    | 该参数为表形式，可以同时传入多个标签。                                 |

代码样例：

```
-- 创建一个名为Damage，初始值为50，且具有Tag1与Tag2标签的整数属性
self:AddAttribute({
    Name = "Damage",
    DataType = "Integer",
    Value = 50,
    Tags = {"Tag1", "Tag2"},
})
```
